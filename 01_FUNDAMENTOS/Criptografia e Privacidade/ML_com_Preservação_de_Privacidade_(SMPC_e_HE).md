# ML com Preservação de Privacidade (SMPC e HE)

## Description

O Machine Learning com Preservação de Privacidade (PPML) refere-se ao uso de técnicas criptográficas e de privacidade para permitir o treinamento e a inferência de modelos de ML em dados confidenciais sem expor o conteúdo dos dados subjacentes. As duas técnicas criptográficas mais proeminentes neste campo são a **Computação Multipartidária Segura (SMPC)** e a **Criptografia Homomórfica (HE)**. A SMPC permite que múltiplas partes colaborem para calcular uma função sobre suas entradas conjuntas, mantendo cada entrada privada. A HE, por outro lado, permite que operações matemáticas arbitrárias (como adição e multiplicação) sejam realizadas diretamente em dados criptografados, produzindo um resultado criptografado que, quando descriptografado, é o mesmo que o resultado da operação realizada em dados não criptografados. Juntas, essas técnicas abordam o desafio de usar dados valiosos para ML enquanto cumprem rigorosos requisitos de privacidade e regulamentações como o GDPR.

## Statistics

A adoção de PPML está crescendo rapidamente, impulsionada pela necessidade de conformidade regulatória e colaboração de dados. Frameworks como o PySyft relatam milhões de downloads, indicando uma comunidade de desenvolvedores ativa. A principal métrica de desempenho para SMPC e HE é a **latência de computação** e o **custo de comunicação**, que são significativamente mais altos do que a computação em texto simples. Por exemplo, a inferência de um modelo simples usando HE pode levar dezenas ou centenas de vezes mais tempo do que a inferência em texto simples, embora o hardware dedicado e as otimizações de protocolo estejam reduzindo essa lacuna.

## Features

### Computação Multipartidária Segura (SMPC)\n*   **Privacidade de Entrada:** Garante que as entradas de cada parte permaneçam confidenciais.\n*   **Corretude:** Garante que o resultado da computação seja correto, como se fosse executado em texto simples.\n*   **Tolerância a Falhas:** Alguns protocolos podem tolerar um certo número de partes desonestas ou falhas.\n*   **Protocolos:** Inclui Circuitos Garbled, Compartilhamento Secreto Aditivo e Protocolos Baseados em HE.\n\n### Criptografia Homomórfica (HE)\n*   **Computação em Dados Criptografados:** Permite operações de ML (como regressão linear, redes neurais simples) diretamente em dados criptografados.\n*   **Homomorfismo Parcial/Total:** HE Parcial (PHE) suporta apenas uma operação (ex: apenas adição ou apenas multiplicação). HE Totalmente Homomórfica (FHE) suporta um número ilimitado de ambas as operações, tornando-a Turing-completa.\n*   **Bootstrapping:** Técnica usada em FHE para 'atualizar' o texto cifrado e reduzir o ruído, permitindo mais operações.

## Use Cases

1.  **Saúde e Pesquisa Médica:** Análise de dados genômicos (GWAS) ou registros eletrônicos de saúde (EHRs) de vários hospitais para treinar modelos de risco de doenças sem compartilhar dados brutos.\n2.  **Serviços Financeiros:** Detecção de fraude e lavagem de dinheiro por meio da análise de transações de vários bancos ou instituições, mantendo a privacidade do cliente.\n3.  **Machine Learning como Serviço (MaaS):** Um provedor de serviços pode hospedar um modelo de ML e realizar inferência em dados criptografados do cliente, garantindo que nem o provedor veja os dados, nem o cliente veja o modelo.\n4.  **Análise Competitiva:** Empresas podem colaborar para calcular métricas de mercado (ex: participação de mercado, preços médios) a partir de seus dados internos sem revelar suas informações proprietárias.

## Integration

A integração de SMPC e HE em fluxos de trabalho de ML é facilitada por bibliotecas de código aberto. O exemplo a seguir demonstra o uso do PySyft para SMPC, permitindo que dois 'trabalhadores' (Alice e Bob) treinem um modelo em seus dados privados.\n\n```python\n# Exemplo de Integração com PySyft (SMPC)\nimport torch\nimport syft as sy\n\nhook = sy.TorchHook(torch)\n\n# Criação de trabalhadores virtuais\nalice = sy.VirtualWorker(hook, id=\"alice\")\nbob = sy.VirtualWorker(hook, id=\"bob\")\n\n# Dados de exemplo (compartilhados entre Alice e Bob)\nx = torch.tensor([1, 2, 3, 4, 5])\ny = torch.tensor([5, 4, 3, 2, 1])\n\n# Enviar dados para os trabalhadores e criptografá-los usando SMPC\nx_ptr = x.share(alice, bob, crypto_provider=sy.VirtualWorker(hook, id=\"crypto\"))\ny_ptr = y.share(alice, bob, crypto_provider=sy.VirtualWorker(hook, id=\"crypto\"))\n\n# Executar computação (ex: adição) em dados criptografados\nz_ptr = x_ptr + y_ptr\n\n# Obter o resultado descriptografado de volta\nz = z_ptr.get()\n\nprint(f\"Resultado da computação segura: {z}\") # Saída: tensor([6, 6, 6, 6, 6])\n\n# Exemplo de Framework de HE: Microsoft SEAL (C++ ou wrappers Python como PySEAL)\n# A lógica envolve a criptografia de vetores de dados, a execução de operações homomórficas\n# (ex: multiplicação de matrizes para inferência de ML) e a descriptografia do resultado.\n```\n\n**Frameworks Chave:**\n*   **PySyft/SyMPC:** Para Deep Learning com SMPC e HE (Python, PyTorch).\n*   **Microsoft SEAL:** Biblioteca de HE de alto desempenho (C++, com wrappers Python).\n*   **MP-SPDZ:** Framework para benchmarking e implementação de vários protocolos MPC (Python).\n*   **TenSEAL:** Biblioteca Python baseada em SEAL para ML com HE.

## URL

https://openmined.org/ (PySyft), https://github.com/microsoft/SEAL (Microsoft SEAL)