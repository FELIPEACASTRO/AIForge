# Vulnerability Assessment Prompts

## Description
Prompts de Avaliação de Vulnerabilidades são instruções de engenharia de prompt projetadas para alavancar Modelos de Linguagem Grande (LLMs) na identificação, análise e priorização de falhas de segurança em código, sistemas, redes ou arquiteturas. Esta técnica se enquadra no campo da cibersegurança e utiliza a capacidade de raciocínio e processamento de linguagem natural dos LLMs para simular análises de segurança, gerar vetores de ataque, sugerir correções e auxiliar na gestão de vulnerabilidades. É crucial que o uso desses prompts seja feito em ambientes controlados e com validação humana, dada a natureza sensível das informações e o risco de alucinações ou vazamento de dados.

## Examples
```
1. **Análise de Código para Injeção SQL:** 'Atue como um analista de segurança sênior. Analise o seguinte trecho de código Python para vulnerabilidades de Injeção SQL. Identifique a linha exata, explique a falha e forneça uma correção segura usando instruções preparadas. [INSERIR CÓDIGO AQUI]'

2. **Geração de Vetor de Ataque:** 'Dado o seguinte diagrama de arquitetura de microsserviços, liste três vetores de ataque de alto risco que um invasor poderia explorar. Para cada vetor, descreva a vulnerabilidade subjacente e o impacto potencial. [INSERIR DESCRIÇÃO DA ARQUITETURA AQUI]'

3. **Revisão de Configuração de Segurança:** 'Avalie o seguinte arquivo de configuração do Nginx para quaisquer configurações de segurança inadequadas ou ausentes, como cabeçalhos de segurança HTTP. Sugira as alterações necessárias para aderir às melhores práticas do OWASP. [INSERIR ARQUIVO DE CONFIGURAÇÃO AQUI]'

4. **Identificação de Vulnerabilidade em Dependência:** 'Analise o arquivo package.json a seguir. Para cada dependência, verifique se há vulnerabilidades conhecidas (CVEs) nos últimos 12 meses. Se encontrado, forneça a versão segura recomendada. [INSERIR package.json AQUI]'

5. **Simulação de Ataque de Engenharia Social:** 'Crie um e-mail de phishing altamente convincente visando um funcionário de nível júnior, com o objetivo de obter suas credenciais de login. O e-mail deve simular uma comunicação urgente do departamento de TI sobre uma atualização de segurança. Não inclua o link malicioso, apenas descreva-o.'

6. **Análise de Log para Comportamento Anômalo:** 'Examine os seguintes logs de autenticação. Identifique qualquer padrão que possa indicar um ataque de força bruta ou enumeração de usuários. Resuma as descobertas e sugira uma regra de detecção para um SIEM. [INSERIR LOGS AQUI]'
```

## Best Practices
1. **Defina o Papel (Persona):** Comece o prompt instruindo o LLM a assumir o papel de um especialista em segurança (por exemplo, 'Atue como um pentester certificado com 10 anos de experiência').
2. **Contextualização Detalhada:** Forneça o máximo de contexto possível, incluindo a linguagem de programação, o framework, o ambiente de execução e o objetivo da análise (por exemplo, 'Foque em vulnerabilidades de Cross-Site Scripting (XSS) no contexto de um aplicativo React').
3. **Instruções de Saída Estruturada:** Peça ao LLM para formatar a saída de forma clara e estruturada (por exemplo, 'Use o formato Markdown com as seções: Vulnerabilidade, Localização, Explicação, Severidade (CVSS), e Correção Sugerida').
4. **Validação Humana (Human-in-the-Loop):** Nunca confie cegamente nas sugestões do LLM. Todas as vulnerabilidades identificadas e correções sugeridas devem ser revisadas e validadas por um profissional de segurança.
5. **Evite Dados Sensíveis:** Nunca insira dados de produção, informações de identificação pessoal (PII) ou segredos de clientes diretamente no prompt, a menos que esteja usando um LLM privado e seguro.

## Use Cases
1. **Análise Estática de Código (SAST):** Identificação rápida de padrões de código inseguros em grandes bases de código.
2. **Geração de Casos de Teste de Segurança:** Criação de cenários de teste de penetração (pentest) e casos de uso de exploração para testes automatizados.
3. **Treinamento e Simulação:** Geração de exemplos de código vulnerável e seguro para fins educacionais e treinamento de desenvolvedores.
4. **Revisão de Políticas e Conformidade:** Avaliação de documentos de política de segurança e configurações de infraestrutura em relação a padrões de conformidade (por exemplo, GDPR, HIPAA, PCI DSS).
5. **Resposta a Incidentes:** Análise de logs de segurança e artefatos de ataque para identificar a causa raiz e sugerir etapas de mitigação.

## Pitfalls
1. **Alucinações e Falsos Positivos:** O LLM pode inventar vulnerabilidades ou sugerir correções incorretas, exigindo validação manual.
2. **Vazamento de Dados (Data Leakage):** A inserção de código proprietário ou dados sensíveis em LLMs públicos pode resultar em vazamento de informações.
3. **Injeção de Prompt (Prompt Injection):** Um LLM pode ser enganado por um prompt malicioso para ignorar instruções de segurança e revelar informações confidenciais ou executar ações não intencionais.
4. **Falta de Profundidade:** LLMs podem ter dificuldade em identificar vulnerabilidades complexas e contextuais que exigem uma compreensão profunda da lógica de negócios ou da arquitetura do sistema.
5. **Viés e Limitações de Treinamento:** O LLM só pode identificar vulnerabilidades que estavam presentes em seus dados de treinamento, podendo falhar em detectar novas classes de ataques (Zero-Day).

## URL
[https://www.thepurplebook.club/blog-posts/prompt-engineering-in-cybersecurity-a-strategic-guide-for-security-experts](https://www.thepurplebook.club/blog-posts/prompt-engineering-in-cybersecurity-a-strategic-guide-for-security-experts)
